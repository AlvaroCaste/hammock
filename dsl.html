<html><head><title>Hammock</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="com.pepegar" /><meta name="description" content="Purely functional HTTP client" /><meta name="og:image" content="/hammock/img/poster.png" /><meta name="og:title" content="Hammock" /><meta name="og:site_name" content="Hammock" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Purely functional HTTP client" /><link rel="icon" type="image/png" href="/hammock/img/favicon.png" /><meta name="twitter:title" content="Hammock" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="Purely functional HTTP client" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/hammock/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/hammock/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/hammock/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/hammock/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/hammock/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/hammock/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/hammock/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/hammock/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/hammock/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/hammock/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/hammock/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/hammock/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/hammock/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/hammock/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/hammock/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/hammock/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/hammock/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/hammock/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/hammock/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/hammock/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/hammock/highlight/styles/tomorrow.css" /><link rel="stylesheet" href="/hammock/css/style.css" /><link rel="stylesheet" href="/hammock/css/palette.css" /><link rel="stylesheet" href="/hammock/css/codemirror.css" /><link rel="stylesheet" href="/hammock/css/kazari-style.css" /><link rel="stylesheet" href="/hammock/css/monokai.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/hammock/" class="brand"><div class="brand-wrapper"><span>Hammock</span></div></a></li> <li><a href="/hammock/interpreters.html" class="">Interpreters</a></li> <li><a href="/hammock/algebras.html" class="">Algebras</a></li> <li><a href="/hammock/marshalling.html" class="">Marshalling</a></li> <li><a href="/hammock/dsl.html" class="">High level DSL</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/pepegar/hammock"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/pepegar/hammock"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('Hammock Purely functional HTTP client');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('Hammock Purely functional HTTP client');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="pepegar" data-github-repo="hammock"><div class="content-wrapper"><section><h1 id="high-level-dsl">High level DSL</h1>

<p>This package provides a high level DSL to use Hammock without the
hassle of dealing with Free monads, interpreters, and so on.</p>

<p>Of course, you’re still able to use lo level API if needed to create
your requests.</p>

<h2 id="example-of-use">Example of use</h2>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">hammock._</span>
<span class="c1">// import hammock._
</span>
<span class="k">import</span> <span class="nn">hammock.jvm.Interpreter</span>
<span class="c1">// import hammock.jvm.Interpreter
</span>
<span class="k">import</span> <span class="nn">hammock.hi._</span>
<span class="c1">// import hammock.hi._
</span>
<span class="k">import</span> <span class="nn">hammock.hi._</span>
<span class="c1">// import hammock.hi._
</span>
<span class="k">import</span> <span class="nn">cats._</span>
<span class="c1">// import cats._
</span>
<span class="k">import</span> <span class="nn">cats.implicits._</span>
<span class="c1">// import cats.implicits._
</span>
<span class="k">import</span> <span class="nn">cats.effect.IO</span>
<span class="c1">// import cats.effect.IO
</span>
<span class="k">implicit</span> <span class="k">val</span> <span class="n">interp</span> <span class="k">=</span> <span class="nc">Interpreter</span><span class="o">[</span><span class="kt">IO</span><span class="o">]</span>
<span class="c1">// interp: hammock.jvm.Interpreter[cats.effect.IO] = hammock.jvm.Interpreter@60990c37
</span>
<span class="k">val</span> <span class="n">opts</span> <span class="k">=</span> <span class="o">(</span><span class="n">header</span><span class="o">(</span><span class="s">"user"</span> <span class="o">-&gt;</span> <span class="s">"pepegar"</span><span class="o">)</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">cookie</span><span class="o">(</span><span class="nc">Cookie</span><span class="o">(</span><span class="s">"track"</span><span class="o">,</span> <span class="s">"a lot"</span><span class="o">)))(</span><span class="nc">Opts</span><span class="o">.</span><span class="n">empty</span><span class="o">)</span>
<span class="c1">// opts: hammock.hi.Opts = Opts(None,Map(user -&gt; pepegar),Some(List(Cookie(track,a lot,None,None,None,None,None,None,None,None))))
</span>
<span class="k">val</span> <span class="n">response</span> <span class="k">=</span> <span class="nc">Hammock</span><span class="o">.</span><span class="n">getWithOpts</span><span class="o">(</span><span class="n">uri</span><span class="s">"http://httpbin.org/get"</span><span class="o">,</span> <span class="n">opts</span><span class="o">).</span><span class="n">exec</span><span class="o">[</span><span class="kt">IO</span><span class="o">]</span>
<span class="c1">// response: cats.effect.IO[hammock.HttpResponse] = IO$662915811
</span></code></pre>
</div>

<h2 id="opts">Opts</h2>

<p>The high level DSL uses a <code class="highlighter-rouge">Opts</code> datatype for describing the request.
This <code class="highlighter-rouge">Opts</code> type is later compiled by the <code class="highlighter-rouge">withOpts</code> methods to the
<code class="highlighter-rouge">Free</code> representation of the request.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">Opts</span><span class="o">(</span>
  <span class="n">auth</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Auth</span><span class="o">],</span>
  <span class="n">headers</span><span class="k">:</span> <span class="kt">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">],</span>
  <span class="n">cookies</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Cookie</span><span class="o">]])</span>
</code></pre>
</div>

<p>All the combinators for manipulating the <code class="highlighter-rouge">Opts</code> type return a value of
the type <code class="highlighter-rouge">Opts =&gt; Opts</code>, so you can combine directly via the <code class="highlighter-rouge">andThen</code>
combinator of <code class="highlighter-rouge">Function1</code>.  Also, since all these combinators are
plain <code class="highlighter-rouge">Function1[Opts, Opts]</code>, for which there’s an instance of
<code class="highlighter-rouge">cats.arrow.Compose</code>, we can use the much nicer <code class="highlighter-rouge">&gt;&gt;&gt;</code> operator.</p>

<h3 id="combinators-that-operate-on-opts">Combinators that operate on <code class="highlighter-rouge">Opts</code></h3>

<table>
  <thead>
    <tr>
      <th>signature</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">auth(a: Auth): Opts =&gt; Opts</code></td>
      <td>Sets the <code class="highlighter-rouge">auth</code> field in opts</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">cookies_!(cookies: List[Cookie]): Opts =&gt; Opts</code></td>
      <td>Substitutes the current value of <code class="highlighter-rouge">cookies</code> in the given <code class="highlighter-rouge">Opts</code> by its param.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">cookies(cookies: List[Cookie]): Opts =&gt; Opts</code></td>
      <td>Appends the given cookies to the current value of <code class="highlighter-rouge">cookies</code>.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">cookie(cookie: Cookie): Opts =&gt; Opts</code></td>
      <td>Adds the given <code class="highlighter-rouge">Cookie</code> to the <code class="highlighter-rouge">Opts</code> value.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">headers_!(headers: Map[String, String]): Opts =&gt; Opts</code></td>
      <td>Sets the <code class="highlighter-rouge">headers</code>.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">headers(headers: Map[String, String]): Opts =&gt; Opts</code></td>
      <td>Appends the given <code class="highlighter-rouge">headers</code> to the former ones.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">header(header: (String, String)): Opts =&gt; Opts</code></td>
      <td>Appends current <code class="highlighter-rouge">header</code> (a <code class="highlighter-rouge">(String, String)</code> value) to the headers map.</td>
    </tr>
  </tbody>
</table>

<p>Here’s an example of how can you use the high level DSL:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">val</span> <span class="n">req</span> <span class="k">=</span> <span class="o">{</span>
  <span class="n">auth</span><span class="o">(</span><span class="nc">Auth</span><span class="o">.</span><span class="nc">BasicAuth</span><span class="o">(</span><span class="s">"pepegar"</span><span class="o">,</span> <span class="s">"p4ssw0rd"</span><span class="o">))</span> <span class="o">&gt;&gt;&gt;</span>
    <span class="n">cookie</span><span class="o">(</span><span class="nc">Cookie</span><span class="o">(</span><span class="s">"track"</span><span class="o">,</span> <span class="s">"A lot"</span><span class="o">))</span> <span class="o">&gt;&gt;&gt;</span>
    <span class="n">header</span><span class="o">(</span><span class="s">"user"</span> <span class="o">-&gt;</span> <span class="s">"potatoman"</span><span class="o">)</span>
<span class="o">}</span>
<span class="c1">// req: hammock.hi.Opts =&gt; hammock.hi.Opts = scala.Function1$$Lambda$7436/45891116@67eeab03
</span></code></pre>
</div>

<p>You can also use <a href="https://github.com/julientruffaut/monocle"><code class="highlighter-rouge">Monocle</code></a>’s optics to describe and modify your
requests.  Most datatypes in Hammock provide sensible optics that will
work out of the box, and you can combine them with the ones provided
in <a href="https://github.com/julientruffaut/monocle"><code class="highlighter-rouge">Monocle</code></a>:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="c1">// import stuff
</span><span class="k">import</span> <span class="nn">hammock.hi._</span><span class="o">,</span> <span class="n">hammock</span><span class="o">.</span><span class="n">hi</span><span class="o">.</span><span class="k">_</span> <span class="o">,</span> <span class="n">monocle</span><span class="o">.</span><span class="k">_</span><span class="o">,</span> <span class="n">monocle</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="k">_</span>
<span class="c1">// import hammock.hi._
// import hammock.hi._
// import monocle._
// import monocle.function.all._
</span>
<span class="c1">// imagine that we have the following Opts value
</span><span class="k">val</span> <span class="n">opts</span> <span class="k">=</span> <span class="o">(</span><span class="n">auth</span><span class="o">(</span><span class="nc">Auth</span><span class="o">.</span><span class="nc">BasicAuth</span><span class="o">(</span><span class="s">"pepe"</span><span class="o">,</span> <span class="s">"password"</span><span class="o">))</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">headers</span><span class="o">(</span><span class="nc">Map</span><span class="o">(</span><span class="s">"X-Correlation-Id"</span> <span class="o">-&gt;</span> <span class="s">"234"</span><span class="o">))</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">cookies</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="nc">Cookie</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">))))(</span><span class="nc">Opts</span><span class="o">.</span><span class="n">empty</span><span class="o">)</span>
<span class="c1">// opts: hammock.hi.Opts = Opts(Some(BasicAuth(pepe,password)),Map(X-Correlation-Id -&gt; 234),Some(List(Cookie(a,b,None,None,None,None,None,None,None,None))))
</span>
<span class="k">import</span> <span class="nn">Opts._</span>
<span class="c1">// import Opts._
</span>
<span class="k">import</span> <span class="nn">Cookie._</span>
<span class="c1">// import Cookie._
</span>
<span class="c1">// Since optics compose nicely, we can focus on
// the first value of the first cookie found in the
// cookie list, for example:
</span>
<span class="n">cookiesOpt</span> <span class="n">composeOptional</span> <span class="n">index</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="n">composeLens</span> <span class="n">value</span>
<span class="c1">// res6: monocle.POptional[hammock.hi.Opts,hammock.hi.Opts,String,String] = monocle.POptional$$anon$2@363e3d4a
</span>
<span class="c1">// also you can use the symbolic operators for that :D
</span><span class="n">cookiesOpt</span> <span class="o">^|-?</span> <span class="n">index</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">^|-&gt;</span> <span class="n">value</span>
<span class="c1">// res8: monocle.POptional[hammock.hi.Opts,hammock.hi.Opts,String,String] = monocle.POptional$$anon$2@87a6993
</span>
<span class="c1">// and then, use the optics machinery at your will, for example for getting the focus
</span><span class="o">(</span><span class="n">cookiesOpt</span> <span class="o">^|-?</span> <span class="n">index</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">^|-&gt;</span> <span class="n">value</span><span class="o">).</span><span class="n">getOption</span><span class="o">(</span><span class="n">opts</span><span class="o">)</span>
<span class="c1">// res10: Option[String] = Some(b)
</span>
<span class="c1">// or modifying it!
</span><span class="o">(</span><span class="n">cookiesOpt</span> <span class="o">^|-?</span> <span class="n">index</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">^|-&gt;</span> <span class="n">value</span><span class="o">).</span><span class="n">set</span><span class="o">(</span><span class="s">"newValue"</span><span class="o">)(</span><span class="n">opts</span><span class="o">)</span>
<span class="c1">// res12: hammock.hi.Opts = Opts(Some(BasicAuth(pepe,password)),Map(X-Correlation-Id -&gt; 234),Some(List(Cookie(a,newValue,None,None,None,None,None,None,None,None))))
</span></code></pre>
</div>

<h4 id="authentication">Authentication</h4>

<p>There are a number of authentication headers already implemented in
Hammock:</p>

<ul>
  <li><strong>Basic auth</strong> (<code class="highlighter-rouge">Auth.BasicAuth(user: String, pass: String)</code>): Authenticate with user and password.</li>
  <li><strong>OAuth2 Bearer token</strong> (<code class="highlighter-rouge">Auth.OAuth2Bearer(token: String)</code>): Authenticate with an OAuth2 Bearer
token. This is treated by many services like a user/password pair</li>
  <li><strong>OAuth2 token</strong> (<code class="highlighter-rouge">Auth.OAuth2Token(token: String)</code>): This is a <em>not really standard</em> bearer token.
Will be treated by services as user/password.</li>
</ul>

<h4 id="cookies">Cookies</h4>

<p>Cookies in Hammock are represented by the <code class="highlighter-rouge">Cookie</code> data type:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">Cookie</span><span class="o">(</span>
  <span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
  <span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
  <span class="n">expires</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Date</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span><span class="o">,</span>
  <span class="n">maxAge</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span><span class="o">,</span>
  <span class="n">domain</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span><span class="o">,</span>
  <span class="n">path</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span><span class="o">,</span>
  <span class="n">secure</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Boolean</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span><span class="o">,</span>
  <span class="n">httpOnly</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Boolean</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span><span class="o">,</span>
  <span class="n">sameSite</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">SameSite</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span><span class="o">,</span>
  <span class="n">custom</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">None</span><span class="o">)</span>
</code></pre>
</div>

<p>In its companion object there are optics for all the
fields. <code class="highlighter-rouge">Cookie.name</code> and <code class="highlighter-rouge">Cookie.value</code> are <code class="highlighter-rouge">Lens</code>es that allow to
focus on one particular field of the structure.</p>

<p>As you can see most of the behaviour of the cookie can be handled by
the type itself.  For example, adding a <code class="highlighter-rouge">MaxAge</code> setting to a cookie
is just matter of doing:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">val</span> <span class="n">cookie</span> <span class="k">=</span> <span class="nc">Cookie</span><span class="o">(</span><span class="s">"_ga"</span><span class="o">,</span> <span class="s">"werwer"</span><span class="o">)</span>
<span class="c1">// cookie: hammock.hi.Cookie = Cookie(_ga,werwer,None,None,None,None,None,None,None,None)
</span>
<span class="nc">Cookie</span><span class="o">.</span><span class="n">maxAge</span><span class="o">.</span><span class="n">set</span><span class="o">(</span><span class="nc">Some</span><span class="o">(</span><span class="mi">234</span><span class="o">))(</span><span class="n">cookie</span><span class="o">)</span>
<span class="c1">// res13: hammock.hi.Cookie = Cookie(_ga,werwer,None,Some(234),None,None,None,None,None,None)
</span></code></pre>
</div>

<h4 id="headers">Headers</h4>

<p>Headers in the <code class="highlighter-rouge">Opts</code> type are represented by a <code class="highlighter-rouge">Map[String, String]</code>.
In this field, you normally want to put all the headers that are not
strictly cookies or authentication header.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/hammock/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'pepegar/hammock'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/hammock/js/main.js"></script><script src="/hammock/js/kazari.js"></script><script>
$(document).ready(function() {
	kazari.KazariPlugin().decorateCode('https://scala-evaluator-212.herokuapp.com/eval', 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.S2F6YXJp.Jl2eqMfw8IakJF93PjxTbrf-8YUJgX5OoOfy5JHE8Yw', '', 'monokai')
})
    </script></body></html>